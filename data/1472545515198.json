{"tag":"android","root":"1472545515198/","file_name":1472545515198,"title":"Android webview控件以及与js进行交互","date":"2016-08-30T08:25:15.201Z","text_2":"Android&nbsp的&nbspWebView&nbsp控件可以浏览html文件<br/>1.以下是xml布局文件","code_3":"&ltWebView<br/>&nbsp&nbsp&nbsp&nbspandroid:layout_width=\"wrap_content\"<br/>&nbsp&nbsp&nbsp&nbspandroid:layout_height=\"match_parent\"<br/>&nbsp&nbsp&nbsp&nbspandroid:id=\"@+id/web\"/&gt","text_4":"布局文件有了，接着就是java代码，使webview可以浏览网页","code_6":"protected&nbspvoid&nbsponCreate(Bundle&nbspsavedInstanceState)&nbsp{<br/>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspsuper.onCreate(savedInstanceState);<br/>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspsetContentView(R.layout.activity_main);<br/>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspweb=(WebView)&nbspfindViewById(R.id.web);<br/>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspweb.loadUrl(\"http://localhost:8080\");<br/>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp//web.loadUrl(\"file:///android_asset/index.html\");这是浏览assets文件夹下的html<br/>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspWebSettings&nbspset=web.getSettings();<br/>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspset.setJavaScriptEnabled(true);//-----------关键，可以调用js代码<br/>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspweb.setWebViewClient(new&nbspshow());//---关键，设置webview查看html否则系统会调用默认浏览器<br/>&nbsp&nbsp&nbsp&nbsp}","text_7":"重写WebViewClient","code_8":"class&nbspshow&nbspextends&nbspWebViewClient{<br/>&nbsp&nbsp&nbsp&nbsppublic&nbspvoid&nbspshouldOverviewUrlLoading(WebView&nbspview,String&nbspurl){<br/>&nbsp&nbsp&nbsp&nbsp&nbspweb.loadUrl(url);<br/>&nbsp&nbsp&nbsp&nbsp}<br/>}","text_12":"<br/><br/><br/>&nbsp&nbspandroid与js的交互，主要代码是web.addJavaScriptInterface(Object,name);","code_13":"web.addJavascriptInterface(new&nbspAClass(),&nbsp\"aaaaa\");//--第一个参数是Object，第二个随便，主要起android与js之间的一个桥梁作用","text_14":"下面是AClass的内容，AClass可以任意写，以下例子写js&nbspalert()的替代品,我因为js的alert在android中无法起作用，所以可以用android中的Toast代替。","code_16":"public&nbspclass&nbspAClass{<br/>&nbsp&nbsp&nbsp&nbsp@JavascriptInterface//-------17版本以上需要加@JavascriptInterface<br/>&nbsp&nbsp&nbsp&nbsppublic&nbspvoid&nbspshowToast(String&nbsptaost){<br/>&nbsp&nbsp&nbsp&nbsp&nbspToast.makeText(Activity_main.this,&nbsptaost,&nbspToast.LENGTH_LONG).show();<br/>&nbsp&nbsp&nbsp&nbsp}<br/>}","text_18":"<br/><br/><br/><br/>&nbsp&nbsp以上Android部分基本就写完了，下面就是在js中调用刚刚写的东西了","code_20":"&ltscript&gt<br/>&nbsp&nbsp&nbsp&nbspvar&nbspstr=\"43958734985734895\";<br/>&nbsp&nbsp&nbsp&nbspaaaaa.showToast(str);<br/>&lt/script&gt","text_21":"以下是运行截图","img_22":"1472547874.png"}